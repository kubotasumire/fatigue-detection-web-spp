{"ast":null,"code":"import { Texture } from \"../Materials/Textures/texture.js\";\nimport { PostProcess } from \"./postProcess.js\";\nimport { Logger } from \"../Misc/logger.js\";\nimport \"../Shaders/imageProcessing.fragment.js\";\nimport \"../Shaders/subSurfaceScattering.fragment.js\";\nimport \"../Shaders/postprocess.vertex.js\";\n/**\n * Sub surface scattering post process\n */\nexport class SubSurfaceScatteringPostProcess extends PostProcess {\n  /**\n   * Gets a string identifying the name of the class\n   * @returns \"SubSurfaceScatteringPostProcess\" string\n   */\n  getClassName() {\n    return \"SubSurfaceScatteringPostProcess\";\n  }\n  constructor(name, scene, options, camera = null, samplingMode, engine, reusable, textureType = 0) {\n    super(name, \"subSurfaceScattering\", [\"texelSize\", \"viewportSize\", \"metersPerUnit\"], [\"diffusionS\", \"diffusionD\", \"filterRadii\", \"irradianceSampler\", \"depthSampler\", \"albedoSampler\"], options, camera, samplingMode || Texture.BILINEAR_SAMPLINGMODE, engine, reusable, null, textureType, \"postprocess\", undefined, true);\n    this._scene = scene;\n    this.updateEffect();\n    this.onApplyObservable.add(effect => {\n      if (!scene.prePassRenderer || !scene.subSurfaceConfiguration) {\n        Logger.Error(\"PrePass and subsurface configuration needs to be enabled for subsurface scattering.\");\n        return;\n      }\n      const texelSize = this.texelSize;\n      effect.setFloat(\"metersPerUnit\", scene.subSurfaceConfiguration.metersPerUnit);\n      effect.setFloat2(\"texelSize\", texelSize.x, texelSize.y);\n      effect.setTexture(\"irradianceSampler\", scene.prePassRenderer.getRenderTarget().textures[scene.prePassRenderer.getIndex(0)]);\n      effect.setTexture(\"depthSampler\", scene.prePassRenderer.getRenderTarget().textures[scene.prePassRenderer.getIndex(5)]);\n      effect.setTexture(\"albedoSampler\", scene.prePassRenderer.getRenderTarget().textures[scene.prePassRenderer.getIndex(7)]);\n      effect.setFloat2(\"viewportSize\", Math.tan(scene.activeCamera.fov / 2) * scene.getEngine().getAspectRatio(scene.activeCamera, true), Math.tan(scene.activeCamera.fov / 2));\n      effect.setArray3(\"diffusionS\", scene.subSurfaceConfiguration.ssDiffusionS);\n      effect.setArray(\"diffusionD\", scene.subSurfaceConfiguration.ssDiffusionD);\n      effect.setArray(\"filterRadii\", scene.subSurfaceConfiguration.ssFilterRadii);\n    });\n  }\n}\n//# sourceMappingURL=subSurfaceScatteringPostProcess.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}