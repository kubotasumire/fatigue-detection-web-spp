{"ast":null,"code":"import { Tools } from \"../../Misc/tools.js\";\nimport { WebXRFeatureName, WebXRFeaturesManager } from \"../webXRFeaturesManager.js\";\nimport { WebXRAbstractFeature } from \"./WebXRAbstractFeature.js\";\n/**\n * DOM Overlay Feature\n *\n * @since 5.0.0\n */\nexport class WebXRDomOverlay extends WebXRAbstractFeature {\n  /**\n   * Creates a new instance of the dom-overlay feature\n   * @param _xrSessionManager an instance of WebXRSessionManager\n   * @param options options to use when constructing this feature\n   */\n  constructor(_xrSessionManager,\n  /**\n   * options to use when constructing this feature\n   */\n  options) {\n    super(_xrSessionManager);\n    this.options = options;\n    /**\n     * Type of overlay - non-null when available\n     */\n    this._domOverlayType = null;\n    /**\n     * Event Listener to supress \"beforexrselect\" events.\n     */\n    this._beforeXRSelectListener = null;\n    /**\n     * Element used for overlay\n     */\n    this._element = null;\n    this.xrNativeFeatureName = \"dom-overlay\";\n    // https://immersive-web.github.io/dom-overlays/\n    Tools.Warn(\"dom-overlay is an experimental and unstable feature.\");\n  }\n  /**\n   * attach this feature\n   * Will usually be called by the features manager\n   *\n   * @returns true if successful.\n   */\n  attach() {\n    if (!super.attach()) {\n      return false;\n    }\n    // Feature not available\n    if (!this._xrSessionManager.session.domOverlayState || this._xrSessionManager.session.domOverlayState.type === null) {\n      return false;\n    }\n    this._domOverlayType = this._xrSessionManager.session.domOverlayState.type;\n    if (this._element !== null && this.options.supressXRSelectEvents === true) {\n      this._beforeXRSelectListener = ev => {\n        ev.preventDefault();\n      };\n      this._element.addEventListener(\"beforexrselect\", this._beforeXRSelectListener);\n    }\n    return true;\n  }\n  /**\n   * The type of DOM overlay (null when not supported).  Provided by UA and remains unchanged for duration of session.\n   */\n  get domOverlayType() {\n    return this._domOverlayType;\n  }\n  /**\n   * Dispose this feature and all of the resources attached\n   */\n  dispose() {\n    super.dispose();\n    if (this._element !== null && this._beforeXRSelectListener) {\n      this._element.removeEventListener(\"beforexrselect\", this._beforeXRSelectListener);\n    }\n  }\n  _onXRFrame(_xrFrame) {\n    /* empty */\n  }\n  /**\n   * Extends the session init object if needed\n   * @returns augmentation object for the xr session init object.\n   */\n  async getXRSessionInitExtension() {\n    if (this.options.element === undefined) {\n      Tools.Warn('\"element\" option must be provided to attach xr-dom-overlay feature.');\n      return {};\n    } else if (typeof this.options.element === \"string\") {\n      const selectedElement = document.querySelector(this.options.element);\n      if (selectedElement === null) {\n        Tools.Warn(`element not found '${this.options.element}' (not requesting xr-dom-overlay)`);\n        return {};\n      }\n      this._element = selectedElement;\n    } else {\n      this._element = this.options.element;\n    }\n    return {\n      domOverlay: {\n        root: this._element\n      }\n    };\n  }\n}\n/**\n * The module's name\n */\nWebXRDomOverlay.Name = WebXRFeatureName.DOM_OVERLAY;\n/**\n * The (Babylon) version of this module.\n * This is an integer representing the implementation version.\n * This number does not correspond to the WebXR specs version\n */\nWebXRDomOverlay.Version = 1;\n//register the plugin\nWebXRFeaturesManager.AddWebXRFeature(WebXRDomOverlay.Name, (xrSessionManager, options) => {\n  return () => new WebXRDomOverlay(xrSessionManager, options);\n}, WebXRDomOverlay.Version, false);\n//# sourceMappingURL=WebXRDOMOverlay.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}