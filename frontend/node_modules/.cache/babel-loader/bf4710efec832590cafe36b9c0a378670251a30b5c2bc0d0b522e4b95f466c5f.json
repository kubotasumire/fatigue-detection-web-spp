{"ast":null,"code":"import { WebGLHardwareTexture } from \"../Engines/WebGL/webGLHardwareTexture.js\";\nimport { InternalTexture, InternalTextureSource } from \"../Materials/Textures/internalTexture.js\";\nimport { MultiviewRenderTarget } from \"../Materials/Textures/MultiviewRenderTarget.js\";\nimport { RenderTargetTexture } from \"../Materials/Textures/renderTargetTexture.js\";\n/**\n * Provides render target textures and other important rendering information for a given XRLayer.\n * @internal\n */\nexport class WebXRLayerRenderTargetTextureProvider {\n  constructor(_scene, layerWrapper) {\n    this._scene = _scene;\n    this.layerWrapper = layerWrapper;\n    this._renderTargetTextures = new Array();\n    this._engine = _scene.getEngine();\n  }\n  _createInternalTexture(textureSize, texture) {\n    const internalTexture = new InternalTexture(this._engine, InternalTextureSource.Unknown, true);\n    internalTexture.width = textureSize.width;\n    internalTexture.height = textureSize.height;\n    internalTexture._hardwareTexture = new WebGLHardwareTexture(texture, this._engine._gl);\n    internalTexture.isReady = true;\n    return internalTexture;\n  }\n  _createRenderTargetTexture(width, height, framebuffer, colorTexture, depthStencilTexture, multiview) {\n    if (!this._engine) {\n      throw new Error(\"Engine is disposed\");\n    }\n    const textureSize = {\n      width,\n      height\n    };\n    // Create render target texture from the internal texture\n    const renderTargetTexture = multiview ? new MultiviewRenderTarget(this._scene, textureSize) : new RenderTargetTexture(\"XR renderTargetTexture\", textureSize, this._scene);\n    const renderTargetWrapper = renderTargetTexture.renderTarget;\n    renderTargetWrapper._samples = renderTargetTexture.samples;\n    // Set the framebuffer, make sure it works in all scenarios - emulator, no layers and layers\n    if (framebuffer || !colorTexture) {\n      renderTargetWrapper._framebuffer = framebuffer;\n    }\n    // Create internal texture\n    if (colorTexture) {\n      if (multiview) {\n        renderTargetWrapper._colorTextureArray = colorTexture;\n      } else {\n        const internalTexture = this._createInternalTexture(textureSize, colorTexture);\n        renderTargetWrapper.setTexture(internalTexture, 0);\n        renderTargetTexture._texture = internalTexture;\n      }\n    }\n    if (depthStencilTexture) {\n      if (multiview) {\n        renderTargetWrapper._depthStencilTextureArray = depthStencilTexture;\n      } else {\n        renderTargetWrapper._depthStencilTexture = this._createInternalTexture(textureSize, depthStencilTexture);\n      }\n    }\n    renderTargetTexture.disableRescaling();\n    this._renderTargetTextures.push(renderTargetTexture);\n    return renderTargetTexture;\n  }\n  _destroyRenderTargetTexture(renderTargetTexture) {\n    this._renderTargetTextures.splice(this._renderTargetTextures.indexOf(renderTargetTexture), 1);\n    renderTargetTexture.dispose();\n  }\n  getFramebufferDimensions() {\n    return this._framebufferDimensions;\n  }\n  dispose() {\n    this._renderTargetTextures.forEach(rtt => rtt.dispose());\n    this._renderTargetTextures.length = 0;\n  }\n}\n//# sourceMappingURL=webXRRenderTargetTextureProvider.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}