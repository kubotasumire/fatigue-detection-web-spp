{"ast":null,"code":"import { __decorate } from \"../tslib.es6.js\";\nimport { serialize } from \"../Misc/decorators.js\";\nimport { MaterialPluginManager } from \"./materialPluginManager.js\";\nimport { SerializationHelper } from \"../Misc/decorators.serialization.js\";\n/**\n * Base class for material plugins.\n * @since 5.0\n */\nexport class MaterialPluginBase {\n  _enable(enable) {\n    if (enable) {\n      this._pluginManager._activatePlugin(this);\n    }\n  }\n  /**\n   * Creates a new material plugin\n   * @param material parent material of the plugin\n   * @param name name of the plugin\n   * @param priority priority of the plugin\n   * @param defines list of defines used by the plugin. The value of the property is the default value for this property\n   * @param addToPluginList true to add the plugin to the list of plugins managed by the material plugin manager of the material (default: true)\n   * @param enable true to enable the plugin (it is handy if the plugin does not handle properties to switch its current activation)\n   * @param resolveIncludes Indicates that any #include directive in the plugin code must be replaced by the corresponding code (default: false)\n   */\n  constructor(material, name, priority, defines, addToPluginList = true, enable = false, resolveIncludes = false) {\n    /**\n     * Defines the priority of the plugin. Lower numbers run first.\n     */\n    this.priority = 500;\n    /**\n     * Indicates that any #include directive in the plugin code must be replaced by the corresponding code.\n     */\n    this.resolveIncludes = false;\n    /**\n     * Indicates that this plugin should be notified for the extra events (HasRenderTargetTextures / FillRenderTargetTextures / HardBindForSubMesh)\n     */\n    this.registerForExtraEvents = false;\n    this._material = material;\n    this.name = name;\n    this.priority = priority;\n    this.resolveIncludes = resolveIncludes;\n    if (!material.pluginManager) {\n      material.pluginManager = new MaterialPluginManager(material);\n      material.onDisposeObservable.add(() => {\n        material.pluginManager = undefined;\n      });\n    }\n    this._pluginDefineNames = defines;\n    this._pluginManager = material.pluginManager;\n    if (addToPluginList) {\n      this._pluginManager._addPlugin(this);\n    }\n    if (enable) {\n      this._enable(true);\n    }\n    this.markAllDefinesAsDirty = material._dirtyCallbacks[63];\n  }\n  /**\n   * Gets the current class name useful for serialization or dynamic coding.\n   * @returns The class name.\n   */\n  getClassName() {\n    return \"MaterialPluginBase\";\n  }\n  /**\n   * Specifies that the submesh is ready to be used.\n   * @param defines the list of \"defines\" to update.\n   * @param scene defines the scene the material belongs to.\n   * @param engine the engine this scene belongs to.\n   * @param subMesh the submesh to check for readiness\n   * @returns - boolean indicating that the submesh is ready or not.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  isReadyForSubMesh(defines, scene, engine, subMesh) {\n    return true;\n  }\n  /**\n   * Binds the material data (this function is called even if mustRebind() returns false)\n   * @param uniformBuffer defines the Uniform buffer to fill in.\n   * @param scene defines the scene the material belongs to.\n   * @param engine defines the engine the material belongs to.\n   * @param subMesh the submesh to bind data for\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  hardBindForSubMesh(uniformBuffer, scene, engine, subMesh) {}\n  /**\n   * Binds the material data.\n   * @param uniformBuffer defines the Uniform buffer to fill in.\n   * @param scene defines the scene the material belongs to.\n   * @param engine the engine this scene belongs to.\n   * @param subMesh the submesh to bind data for\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  bindForSubMesh(uniformBuffer, scene, engine, subMesh) {}\n  /**\n   * Disposes the resources of the material.\n   * @param forceDisposeTextures - Forces the disposal of all textures.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  dispose(forceDisposeTextures) {}\n  /**\n   * Returns a list of custom shader code fragments to customize the shader.\n   * @param shaderType \"vertex\" or \"fragment\"\n   * @returns null if no code to be added, or a list of pointName =\\> code.\n   * Note that `pointName` can also be a regular expression if it starts with a `!`.\n   * In that case, the string found by the regular expression (if any) will be\n   * replaced by the code provided.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  getCustomCode(shaderType) {\n    return null;\n  }\n  /**\n   * Collects all defines.\n   * @param defines The object to append to.\n   */\n  collectDefines(defines) {\n    if (!this._pluginDefineNames) {\n      return;\n    }\n    for (const key of Object.keys(this._pluginDefineNames)) {\n      if (key[0] === \"_\") {\n        continue;\n      }\n      const type = typeof this._pluginDefineNames[key];\n      defines[key] = {\n        type: type === \"number\" ? \"number\" : type === \"string\" ? \"string\" : type === \"boolean\" ? \"boolean\" : \"object\",\n        default: this._pluginDefineNames[key]\n      };\n    }\n  }\n  /**\n   * Sets the defines for the next rendering. Called before PrepareDefinesForAttributes is called.\n   * @param defines the list of \"defines\" to update.\n   * @param scene defines the scene to the material belongs to.\n   * @param mesh the mesh being rendered\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  prepareDefinesBeforeAttributes(defines, scene, mesh) {}\n  /**\n   * Sets the defines for the next rendering\n   * @param defines the list of \"defines\" to update.\n   * @param scene defines the scene to the material belongs to.\n   * @param mesh the mesh being rendered\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  prepareDefines(defines, scene, mesh) {}\n  /**\n   * Checks to see if a texture is used in the material.\n   * @param texture - Base texture to use.\n   * @returns - Boolean specifying if a texture is used in the material.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  hasTexture(texture) {\n    return false;\n  }\n  /**\n   * Gets a boolean indicating that current material needs to register RTT\n   * @returns true if this uses a render target otherwise false.\n   */\n  hasRenderTargetTextures() {\n    return false;\n  }\n  /**\n   * Fills the list of render target textures.\n   * @param renderTargets the list of render targets to update\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  fillRenderTargetTextures(renderTargets) {}\n  /**\n   * Returns an array of the actively used textures.\n   * @param activeTextures Array of BaseTextures\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  getActiveTextures(activeTextures) {}\n  /**\n   * Returns the animatable textures.\n   * @param animatables Array of animatable textures.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  getAnimatables(animatables) {}\n  /**\n   * Add fallbacks to the effect fallbacks list.\n   * @param defines defines the Base texture to use.\n   * @param fallbacks defines the current fallback list.\n   * @param currentRank defines the current fallback rank.\n   * @returns the new fallback rank.\n   */\n  addFallbacks(defines, fallbacks, currentRank) {\n    return currentRank;\n  }\n  /**\n   * Gets the samplers used by the plugin.\n   * @param samplers list that the sampler names should be added to.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  getSamplers(samplers) {}\n  /**\n   * Gets the attributes used by the plugin.\n   * @param attributes list that the attribute names should be added to.\n   * @param scene the scene that the material belongs to.\n   * @param mesh the mesh being rendered.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  getAttributes(attributes, scene, mesh) {}\n  /**\n   * Gets the uniform buffers names added by the plugin.\n   * @param ubos list that the ubo names should be added to.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  getUniformBuffersNames(ubos) {}\n  /**\n   * Gets the description of the uniforms to add to the ubo (if engine supports ubos) or to inject directly in the vertex/fragment shaders (if engine does not support ubos)\n   * @returns the description of the uniforms\n   */\n  getUniforms() {\n    return {};\n  }\n  /**\n   * Makes a duplicate of the current configuration into another one.\n   * @param plugin define the config where to copy the info\n   */\n  copyTo(plugin) {\n    SerializationHelper.Clone(() => plugin, this);\n  }\n  /**\n   * Serializes this plugin configuration.\n   * @returns - An object with the serialized config.\n   */\n  serialize() {\n    return SerializationHelper.Serialize(this);\n  }\n  /**\n   * Parses a plugin configuration from a serialized object.\n   * @param source - Serialized object.\n   * @param scene Defines the scene we are parsing for\n   * @param rootUrl Defines the rootUrl to load from\n   */\n  parse(source, scene, rootUrl) {\n    SerializationHelper.Parse(() => this, source, scene, rootUrl);\n  }\n}\n__decorate([serialize()], MaterialPluginBase.prototype, \"name\", void 0);\n__decorate([serialize()], MaterialPluginBase.prototype, \"priority\", void 0);\n__decorate([serialize()], MaterialPluginBase.prototype, \"resolveIncludes\", void 0);\n__decorate([serialize()], MaterialPluginBase.prototype, \"registerForExtraEvents\", void 0);\n//# sourceMappingURL=materialPluginBase.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}