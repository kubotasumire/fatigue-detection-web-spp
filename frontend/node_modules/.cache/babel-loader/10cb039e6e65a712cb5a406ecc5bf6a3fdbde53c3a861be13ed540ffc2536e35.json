{"ast":null,"code":"import { FluidRenderingObject } from \"./fluidRenderingObject.js\";\n/**\n * Defines a rendering object based on a particle system\n */\nexport class FluidRenderingObjectParticleSystem extends FluidRenderingObject {\n  /** Gets the particle system */\n  get particleSystem() {\n    return this._particleSystem;\n  }\n  /**\n   * @returns the name of the class\n   */\n  getClassName() {\n    return \"FluidRenderingObjectParticleSystem\";\n  }\n  /**\n   * Gets or sets a boolean indicating that the diffuse texture should be generated based on the regular rendering of the particle system (default: true).\n   * Sometimes, generating the diffuse texture this way may be sub-optimal. In that case, you can disable this property, in which case the particle system will be\n   * rendered using a ALPHA_COMBINE mode instead of the one used by the particle system.\n   */\n  get useTrueRenderingForDiffuseTexture() {\n    return this._useTrueRenderingForDiffuseTexture;\n  }\n  set useTrueRenderingForDiffuseTexture(use) {\n    if (this._useTrueRenderingForDiffuseTexture === use) {\n      return;\n    }\n    this._useTrueRenderingForDiffuseTexture = use;\n    if (use) {\n      this._particleSystem.blendMode = this._blendMode;\n      this._particleSystem.onBeforeDrawParticlesObservable.remove(this._onBeforeDrawParticleObserver);\n      this._onBeforeDrawParticleObserver = null;\n    } else {\n      this._particleSystem.blendMode = -1;\n      this._onBeforeDrawParticleObserver = this._particleSystem.onBeforeDrawParticlesObservable.add(() => {\n        this._engine.setAlphaMode(2);\n      });\n    }\n  }\n  /**\n   * Gets the vertex buffers\n   */\n  get vertexBuffers() {\n    return this._particleSystem.vertexBuffers;\n  }\n  /**\n   * Gets the index buffer (or null if the object is using instancing)\n   */\n  get indexBuffer() {\n    return this._particleSystem.indexBuffer;\n  }\n  /**\n   * Creates a new instance of the class\n   * @param scene The scene the particle system is part of\n   * @param ps The particle system\n   */\n  constructor(scene, ps) {\n    super(scene);\n    this._useTrueRenderingForDiffuseTexture = true;\n    this._particleSystem = ps;\n    this._originalRender = ps.render.bind(ps);\n    this._blendMode = ps.blendMode;\n    this._onBeforeDrawParticleObserver = null;\n    this._updateInAnimate = this._particleSystem.updateInAnimate;\n    this._particleSystem.updateInAnimate = true;\n    this._particleSystem.render = () => 0;\n    this.particleSize = (ps.minSize + ps.maxSize) / 2;\n    this.useTrueRenderingForDiffuseTexture = false;\n  }\n  /**\n   * Indicates if the object is ready to be rendered\n   * @returns True if everything is ready for the object to be rendered, otherwise false\n   */\n  isReady() {\n    return super.isReady() && this._particleSystem.isReady();\n  }\n  /**\n   * Gets the number of particles in this particle system\n   * @returns The number of particles\n   */\n  get numParticles() {\n    return this._particleSystem.getActiveCount();\n  }\n  /**\n   * Render the diffuse texture for this object\n   */\n  renderDiffuseTexture() {\n    this._originalRender();\n  }\n  /**\n   * Releases the ressources used by the class\n   */\n  dispose() {\n    super.dispose();\n    this._particleSystem.onBeforeDrawParticlesObservable.remove(this._onBeforeDrawParticleObserver);\n    this._onBeforeDrawParticleObserver = null;\n    this._particleSystem.render = this._originalRender;\n    this._particleSystem.blendMode = this._blendMode;\n    this._particleSystem.updateInAnimate = this._updateInAnimate;\n  }\n}\n//# sourceMappingURL=fluidRenderingObjectParticleSystem.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}