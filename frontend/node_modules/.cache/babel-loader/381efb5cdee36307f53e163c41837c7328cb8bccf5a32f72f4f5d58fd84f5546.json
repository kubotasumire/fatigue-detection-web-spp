{"ast":null,"code":"import { FlowGraphBlock } from \"../../flowGraphBlock.js\";\nimport { RichTypeAny, RichTypeVector3 } from \"../../flowGraphRichTypes.js\";\nimport { TmpVectors, Vector3 } from \"../../../Maths/math.vector.js\";\nimport { RegisterClass } from \"../../../Misc/typeStore.js\";\n/**\n * @experimental\n * This blocks transforms a vector from one coordinate system to another.\n */\nexport class FlowGraphCoordinateTransformBlock extends FlowGraphBlock {\n  /**\n   * Creates a new FlowGraphCoordinateTransformBlock\n   * @param config optional configuration for this block\n   */\n  constructor(config) {\n    super(config);\n    this.sourceSystem = this.registerDataInput(\"sourceSystem\", RichTypeAny);\n    this.destinationSystem = this.registerDataInput(\"destinationSystem\", RichTypeAny);\n    this.inputCoordinates = this.registerDataInput(\"inputCoordinates\", RichTypeVector3);\n    this.outputCoordinates = this.registerDataOutput(\"outputCoordinates\", RichTypeVector3);\n  }\n  _updateOutputs(_context) {\n    const sourceSystemValue = this.sourceSystem.getValue(_context);\n    const destinationSystemValue = this.destinationSystem.getValue(_context);\n    const inputCoordinatesValue = this.inputCoordinates.getValue(_context);\n    // takes coordinates from source space to world space\n    const sourceWorld = sourceSystemValue.getWorldMatrix();\n    // takes coordinates from destination space to world space\n    const destinationWorld = destinationSystemValue.getWorldMatrix();\n    const destinationWorldInverse = TmpVectors.Matrix[0].copyFrom(destinationWorld);\n    // takes coordinates from world space to destination space\n    destinationWorldInverse.invert();\n    const sourceToDestination = TmpVectors.Matrix[1];\n    // takes coordinates from source space to world space to destination space\n    destinationWorldInverse.multiplyToRef(sourceWorld, sourceToDestination);\n    const outputCoordinatesValue = this.outputCoordinates.getValue(_context);\n    Vector3.TransformCoordinatesToRef(inputCoordinatesValue, sourceToDestination, outputCoordinatesValue);\n  }\n  /**\n   * Gets the class name of this block\n   * @returns the class name\n   */\n  getClassName() {\n    return \"FGCoordinateTransformBlock\";\n  }\n}\nRegisterClass(\"FGCoordinateTransformBlock\", FlowGraphCoordinateTransformBlock);\n//# sourceMappingURL=flowGraphCoordinateTransformBlock.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}