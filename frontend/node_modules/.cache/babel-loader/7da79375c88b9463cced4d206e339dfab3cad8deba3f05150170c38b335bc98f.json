{"ast":null,"code":"/** @internal */\n// eslint-disable-next-line @typescript-eslint/naming-convention\nfunction createXMLHttpRequest() {\n  // If running in Babylon Native, then defer to the native XMLHttpRequest, which has the same public contract\n  if (typeof _native !== \"undefined\" && _native.XMLHttpRequest) {\n    return new _native.XMLHttpRequest();\n  } else {\n    return new XMLHttpRequest();\n  }\n}\n/**\n * Extended version of XMLHttpRequest with support for customizations (headers, ...)\n */\nexport class WebRequest {\n  constructor() {\n    this._xhr = createXMLHttpRequest();\n    this._requestURL = \"\";\n  }\n  /**\n   * This function can be called to check if there are request modifiers for network requests\n   * @returns true if there are any custom requests available\n   */\n  static get IsCustomRequestAvailable() {\n    return Object.keys(WebRequest.CustomRequestHeaders).length > 0 || WebRequest.CustomRequestModifiers.length > 0;\n  }\n  _injectCustomRequestHeaders() {\n    if (this._shouldSkipRequestModifications(this._requestURL)) {\n      return;\n    }\n    for (const key in WebRequest.CustomRequestHeaders) {\n      const val = WebRequest.CustomRequestHeaders[key];\n      if (val) {\n        this._xhr.setRequestHeader(key, val);\n      }\n    }\n  }\n  _shouldSkipRequestModifications(url) {\n    return WebRequest.SkipRequestModificationForBabylonCDN && (url.includes(\"preview.babylonjs.com\") || url.includes(\"cdn.babylonjs.com\"));\n  }\n  /**\n   * Gets or sets a function to be called when loading progress changes\n   */\n  get onprogress() {\n    return this._xhr.onprogress;\n  }\n  set onprogress(value) {\n    this._xhr.onprogress = value;\n  }\n  /**\n   * Returns client's state\n   */\n  get readyState() {\n    return this._xhr.readyState;\n  }\n  /**\n   * Returns client's status\n   */\n  get status() {\n    return this._xhr.status;\n  }\n  /**\n   * Returns client's status as a text\n   */\n  get statusText() {\n    return this._xhr.statusText;\n  }\n  /**\n   * Returns client's response\n   */\n  get response() {\n    return this._xhr.response;\n  }\n  /**\n   * Returns client's response url\n   */\n  get responseURL() {\n    return this._xhr.responseURL;\n  }\n  /**\n   * Returns client's response as text\n   */\n  get responseText() {\n    return this._xhr.responseText;\n  }\n  /**\n   * Gets or sets the expected response type\n   */\n  get responseType() {\n    return this._xhr.responseType;\n  }\n  set responseType(value) {\n    this._xhr.responseType = value;\n  }\n  /**\n   * Gets or sets the timeout value in milliseconds\n   */\n  get timeout() {\n    return this._xhr.timeout;\n  }\n  set timeout(value) {\n    this._xhr.timeout = value;\n  }\n  addEventListener(type, listener, options) {\n    this._xhr.addEventListener(type, listener, options);\n  }\n  removeEventListener(type, listener, options) {\n    this._xhr.removeEventListener(type, listener, options);\n  }\n  /**\n   * Cancels any network activity\n   */\n  abort() {\n    this._xhr.abort();\n  }\n  /**\n   * Initiates the request. The optional argument provides the request body. The argument is ignored if request method is GET or HEAD\n   * @param body defines an optional request body\n   */\n  send(body) {\n    if (WebRequest.CustomRequestHeaders) {\n      this._injectCustomRequestHeaders();\n    }\n    this._xhr.send(body);\n  }\n  /**\n   * Sets the request method, request URL\n   * @param method defines the method to use (GET, POST, etc..)\n   * @param url defines the url to connect with\n   */\n  open(method, url) {\n    for (const update of WebRequest.CustomRequestModifiers) {\n      if (this._shouldSkipRequestModifications(url)) {\n        return;\n      }\n      update(this._xhr, url);\n    }\n    // Clean url\n    url = url.replace(\"file:http:\", \"http:\");\n    url = url.replace(\"file:https:\", \"https:\");\n    this._requestURL = url;\n    this._xhr.open(method, url, true);\n  }\n  /**\n   * Sets the value of a request header.\n   * @param name The name of the header whose value is to be set\n   * @param value The value to set as the body of the header\n   */\n  setRequestHeader(name, value) {\n    this._xhr.setRequestHeader(name, value);\n  }\n  /**\n   * Get the string containing the text of a particular header's value.\n   * @param name The name of the header\n   * @returns The string containing the text of the given header name\n   */\n  getResponseHeader(name) {\n    return this._xhr.getResponseHeader(name);\n  }\n}\n/**\n * Custom HTTP Request Headers to be sent with XMLHttpRequests\n * i.e. when loading files, where the server/service expects an Authorization header\n */\nWebRequest.CustomRequestHeaders = {};\n/**\n * Add callback functions in this array to update all the requests before they get sent to the network\n */\nWebRequest.CustomRequestModifiers = new Array();\n/**\n * If set to true, requests to Babylon.js CDN requests will not be modified\n */\nWebRequest.SkipRequestModificationForBabylonCDN = true;\n//# sourceMappingURL=webRequest.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}