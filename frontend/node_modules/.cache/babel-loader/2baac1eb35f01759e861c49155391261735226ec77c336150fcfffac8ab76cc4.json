{"ast":null,"code":"var _jsxFileName = \"/Users/kubotasumire/Univ./\\u5352\\u8AD6/s-2/fatigue-detection-web-spp/frontend/src/App.jsx\";\nimport React, { useState, useEffect, useRef } from 'react';\nimport StartScreen from './components/StartScreen';\nimport GameScene from './components/GameScene';\nimport EndScreen from './components/EndScreen';\nimport './App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  const [gameState, setGameState] = useState('start'); // start, playing, end\n  const [selectedDifficulty, setSelectedDifficulty] = useState(null);\n  const [sessionId, setSessionId] = useState(null);\n  const [sessionData, setSessionData] = useState(null);\n  const sessionDataRef = useRef(null);\n\n  // ゲーム開始時\n  const handleDifficultySelect = async difficulty => {\n    const newSessionId = `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    try {\n      // バックエンドにセッション開始を通知\n      const response = await fetch('http://localhost:5001/api/data/session/start', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          difficulty,\n          timestamp: Date.now()\n        })\n      });\n      const data = await response.json();\n      setSelectedDifficulty(difficulty);\n      setSessionId(data.sessionId);\n      setGameState('playing');\n\n      // セッションデータをメモリに保存\n      sessionDataRef.current = {\n        id: data.sessionId,\n        difficulty,\n        startTime: Date.now(),\n        sensorData: [],\n        quizResponses: [],\n        endTime: null\n      };\n    } catch (error) {\n      console.error('Failed to start session:', error);\n    }\n  };\n\n  // クイズ回答データを記録\n  const handleQuizResponse = (quizId, isCorrect) => {\n    if (!sessionDataRef.current) return;\n    sessionDataRef.current.quizResponses.push({\n      quizId,\n      isCorrect,\n      timestamp: Date.now()\n    });\n    console.log(`Quiz response recorded: ${quizId} - ${isCorrect ? 'correct' : 'incorrect'}`);\n    console.log(`Total responses: ${sessionDataRef.current.quizResponses.length}`);\n  };\n\n  // ゲーム終了時\n  const handleGameEnd = async reason => {\n    if (!sessionDataRef.current) return;\n    const endTime = Date.now();\n    sessionDataRef.current.endTime = endTime;\n    console.log('=== Game End - Final Session Data ===');\n    console.log('Quiz Responses:', sessionDataRef.current.quizResponses);\n    try {\n      // バックエンドにセッション終了を通知\n      await fetch('http://localhost:5001/api/data/session/end', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          sessionId,\n          timestamp: endTime\n        })\n      });\n\n      // セッションデータを保存して終了画面へ\n      setSessionData(sessionDataRef.current);\n      setGameState('end');\n    } catch (error) {\n      console.error('Failed to end session:', error);\n      setGameState('end');\n    }\n  };\n  const handleTimeUp = () => {\n    console.log('時間終了');\n    handleGameEnd({\n      reason: 'timeup'\n    });\n  };\n\n  // スタート画面に戻る\n  const handleRestart = () => {\n    setGameState('start');\n    setSelectedDifficulty(null);\n    setSessionId(null);\n    setSessionData(null);\n    sessionDataRef.current = null;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: [gameState === 'start' && /*#__PURE__*/_jsxDEV(StartScreen, {\n      onDifficultySelect: handleDifficultySelect\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 33\n    }, this), gameState === 'playing' && /*#__PURE__*/_jsxDEV(GameScene, {\n      difficulty: selectedDifficulty,\n      sessionId: sessionId,\n      onGameEnd: handleGameEnd,\n      onTimeUp: handleTimeUp,\n      onQuizResponse: handleQuizResponse\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 9\n    }, this), gameState === 'end' && sessionData && /*#__PURE__*/_jsxDEV(EndScreen, {\n      sessionData: sessionData,\n      difficulty: selectedDifficulty,\n      onRestart: handleRestart\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 108,\n    columnNumber: 5\n  }, this);\n}\nexport default App;","map":{"version":3,"names":["React","useState","useEffect","useRef","StartScreen","GameScene","EndScreen","jsxDEV","_jsxDEV","App","gameState","setGameState","selectedDifficulty","setSelectedDifficulty","sessionId","setSessionId","sessionData","setSessionData","sessionDataRef","handleDifficultySelect","difficulty","newSessionId","Date","now","Math","random","toString","substr","response","fetch","method","headers","body","JSON","stringify","timestamp","data","json","current","id","startTime","sensorData","quizResponses","endTime","error","console","handleQuizResponse","quizId","isCorrect","push","log","length","handleGameEnd","reason","handleTimeUp","handleRestart","className","children","onDifficultySelect","fileName","_jsxFileName","lineNumber","columnNumber","onGameEnd","onTimeUp","onQuizResponse","onRestart"],"sources":["/Users/kubotasumire/Univ./卒論/s-2/fatigue-detection-web-spp/frontend/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport StartScreen from './components/StartScreen';\nimport GameScene from './components/GameScene';\nimport EndScreen from './components/EndScreen';\nimport './App.css';\n\nfunction App() {\n  const [gameState, setGameState] = useState('start'); // start, playing, end\n  const [selectedDifficulty, setSelectedDifficulty] = useState(null);\n  const [sessionId, setSessionId] = useState(null);\n  const [sessionData, setSessionData] = useState(null);\n  const sessionDataRef = useRef(null);\n\n  // ゲーム開始時\n  const handleDifficultySelect = async (difficulty) => {\n    const newSessionId = `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n\n    try {\n      // バックエンドにセッション開始を通知\n      const response = await fetch('http://localhost:5001/api/data/session/start', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          difficulty,\n          timestamp: Date.now()\n        })\n      });\n\n      const data = await response.json();\n\n      setSelectedDifficulty(difficulty);\n      setSessionId(data.sessionId);\n      setGameState('playing');\n\n      // セッションデータをメモリに保存\n      sessionDataRef.current = {\n        id: data.sessionId,\n        difficulty,\n        startTime: Date.now(),\n        sensorData: [],\n        quizResponses: [],\n        endTime: null\n      };\n    } catch (error) {\n      console.error('Failed to start session:', error);\n    }\n  };\n\n  // クイズ回答データを記録\n  const handleQuizResponse = (quizId, isCorrect) => {\n    if (!sessionDataRef.current) return;\n\n    sessionDataRef.current.quizResponses.push({\n      quizId,\n      isCorrect,\n      timestamp: Date.now()\n    });\n\n    console.log(`Quiz response recorded: ${quizId} - ${isCorrect ? 'correct' : 'incorrect'}`);\n    console.log(`Total responses: ${sessionDataRef.current.quizResponses.length}`);\n  };\n\n  // ゲーム終了時\n  const handleGameEnd = async (reason) => {\n    if (!sessionDataRef.current) return;\n\n    const endTime = Date.now();\n    sessionDataRef.current.endTime = endTime;\n\n    console.log('=== Game End - Final Session Data ===');\n    console.log('Quiz Responses:', sessionDataRef.current.quizResponses);\n\n    try {\n      // バックエンドにセッション終了を通知\n      await fetch('http://localhost:5001/api/data/session/end', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          sessionId,\n          timestamp: endTime\n        })\n      });\n\n      // セッションデータを保存して終了画面へ\n      setSessionData(sessionDataRef.current);\n      setGameState('end');\n    } catch (error) {\n      console.error('Failed to end session:', error);\n      setGameState('end');\n    }\n  };\n\n  const handleTimeUp = () => {\n    console.log('時間終了');\n    handleGameEnd({ reason: 'timeup' });\n  };\n\n  // スタート画面に戻る\n  const handleRestart = () => {\n    setGameState('start');\n    setSelectedDifficulty(null);\n    setSessionId(null);\n    setSessionData(null);\n    sessionDataRef.current = null;\n  };\n\n  return (\n    <div className=\"App\">\n      {gameState === 'start' && <StartScreen onDifficultySelect={handleDifficultySelect} />}\n\n      {gameState === 'playing' && (\n        <GameScene\n          difficulty={selectedDifficulty}\n          sessionId={sessionId}\n          onGameEnd={handleGameEnd}\n          onTimeUp={handleTimeUp}\n          onQuizResponse={handleQuizResponse}\n        />\n      )}\n\n      {gameState === 'end' && sessionData && (\n        <EndScreen sessionData={sessionData} difficulty={selectedDifficulty} onRestart={handleRestart} />\n      )}\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}