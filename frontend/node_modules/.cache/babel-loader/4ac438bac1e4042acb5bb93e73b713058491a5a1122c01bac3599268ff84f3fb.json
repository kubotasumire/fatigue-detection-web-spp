{"ast":null,"code":"import { Vector2 } from \"../Maths/math.vector.js\";\nimport { Texture } from \"../Materials/Textures/texture.js\";\nimport { PostProcess } from \"./postProcess.js\";\nimport \"../Shaders/vrDistortionCorrection.fragment.js\";\n/**\n * VRDistortionCorrectionPostProcess used for mobile VR\n */\nexport class VRDistortionCorrectionPostProcess extends PostProcess {\n  /**\n   * Gets a string identifying the name of the class\n   * @returns \"VRDistortionCorrectionPostProcess\" string\n   */\n  getClassName() {\n    return \"VRDistortionCorrectionPostProcess\";\n  }\n  /**\n   * Initializes the VRDistortionCorrectionPostProcess\n   * @param name The name of the effect.\n   * @param camera The camera to apply the render pass to.\n   * @param isRightEye If this is for the right eye distortion\n   * @param vrMetrics All the required metrics for the VR camera\n   */\n  constructor(name, camera, isRightEye, vrMetrics) {\n    super(name, \"vrDistortionCorrection\", [\"LensCenter\", \"Scale\", \"ScaleIn\", \"HmdWarpParam\"], null, vrMetrics.postProcessScaleFactor, camera, Texture.BILINEAR_SAMPLINGMODE);\n    this._isRightEye = isRightEye;\n    this._distortionFactors = vrMetrics.distortionK;\n    this._postProcessScaleFactor = vrMetrics.postProcessScaleFactor;\n    this._lensCenterOffset = vrMetrics.lensCenterOffset;\n    this.adaptScaleToCurrentViewport = true;\n    this.onSizeChangedObservable.add(() => {\n      this._scaleIn = new Vector2(2, 2 / this.aspectRatio);\n      this._scaleFactor = new Vector2(0.5 * (1 / this._postProcessScaleFactor), 0.5 * (1 / this._postProcessScaleFactor) * this.aspectRatio);\n      this._lensCenter = new Vector2(this._isRightEye ? 0.5 - this._lensCenterOffset * 0.5 : 0.5 + this._lensCenterOffset * 0.5, 0.5);\n    });\n    this.onApplyObservable.add(effect => {\n      effect.setFloat2(\"LensCenter\", this._lensCenter.x, this._lensCenter.y);\n      effect.setFloat2(\"Scale\", this._scaleFactor.x, this._scaleFactor.y);\n      effect.setFloat2(\"ScaleIn\", this._scaleIn.x, this._scaleIn.y);\n      effect.setFloat4(\"HmdWarpParam\", this._distortionFactors[0], this._distortionFactors[1], this._distortionFactors[2], this._distortionFactors[3]);\n    });\n  }\n}\n//# sourceMappingURL=vrDistortionCorrectionPostProcess.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}