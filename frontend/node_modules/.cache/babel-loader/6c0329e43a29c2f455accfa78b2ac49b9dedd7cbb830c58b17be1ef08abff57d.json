{"ast":null,"code":"/** @internal */\nexport class WebGLPipelineContext {\n  constructor() {\n    this._valueCache = {};\n    this.vertexCompilationError = null;\n    this.fragmentCompilationError = null;\n    this.programLinkError = null;\n    this.programValidationError = null;\n    /** @internal */\n    this._isDisposed = false;\n  }\n  get isAsync() {\n    return this.isParallelCompiled;\n  }\n  get isReady() {\n    if (this.program) {\n      if (this.isParallelCompiled) {\n        return this.engine._isRenderingStateCompiled(this);\n      }\n      return true;\n    }\n    return false;\n  }\n  _handlesSpectorRebuildCallback(onCompiled) {\n    if (onCompiled && this.program) {\n      onCompiled(this.program);\n    }\n  }\n  _fillEffectInformation(effect, uniformBuffersNames, uniformsNames, uniforms, samplerList, samplers, attributesNames, attributes) {\n    const engine = this.engine;\n    if (engine.supportsUniformBuffers) {\n      for (const name in uniformBuffersNames) {\n        effect.bindUniformBlock(name, uniformBuffersNames[name]);\n      }\n    }\n    const effectAvailableUniforms = this.engine.getUniforms(this, uniformsNames);\n    effectAvailableUniforms.forEach((uniform, index) => {\n      uniforms[uniformsNames[index]] = uniform;\n    });\n    this._uniforms = uniforms;\n    let index;\n    for (index = 0; index < samplerList.length; index++) {\n      const sampler = effect.getUniform(samplerList[index]);\n      if (sampler == null) {\n        samplerList.splice(index, 1);\n        index--;\n      }\n    }\n    samplerList.forEach((name, index) => {\n      samplers[name] = index;\n    });\n    for (const attr of engine.getAttributes(this, attributesNames)) {\n      attributes.push(attr);\n    }\n  }\n  /**\n   * Release all associated resources.\n   **/\n  dispose() {\n    this._uniforms = {};\n    this._isDisposed = true;\n  }\n  /**\n   * @internal\n   */\n  _cacheMatrix(uniformName, matrix) {\n    const cache = this._valueCache[uniformName];\n    const flag = matrix.updateFlag;\n    if (cache !== undefined && cache === flag) {\n      return false;\n    }\n    this._valueCache[uniformName] = flag;\n    return true;\n  }\n  /**\n   * @internal\n   */\n  _cacheFloat2(uniformName, x, y) {\n    let cache = this._valueCache[uniformName];\n    if (!cache || cache.length !== 2) {\n      cache = [x, y];\n      this._valueCache[uniformName] = cache;\n      return true;\n    }\n    let changed = false;\n    if (cache[0] !== x) {\n      cache[0] = x;\n      changed = true;\n    }\n    if (cache[1] !== y) {\n      cache[1] = y;\n      changed = true;\n    }\n    return changed;\n  }\n  /**\n   * @internal\n   */\n  _cacheFloat3(uniformName, x, y, z) {\n    let cache = this._valueCache[uniformName];\n    if (!cache || cache.length !== 3) {\n      cache = [x, y, z];\n      this._valueCache[uniformName] = cache;\n      return true;\n    }\n    let changed = false;\n    if (cache[0] !== x) {\n      cache[0] = x;\n      changed = true;\n    }\n    if (cache[1] !== y) {\n      cache[1] = y;\n      changed = true;\n    }\n    if (cache[2] !== z) {\n      cache[2] = z;\n      changed = true;\n    }\n    return changed;\n  }\n  /**\n   * @internal\n   */\n  _cacheFloat4(uniformName, x, y, z, w) {\n    let cache = this._valueCache[uniformName];\n    if (!cache || cache.length !== 4) {\n      cache = [x, y, z, w];\n      this._valueCache[uniformName] = cache;\n      return true;\n    }\n    let changed = false;\n    if (cache[0] !== x) {\n      cache[0] = x;\n      changed = true;\n    }\n    if (cache[1] !== y) {\n      cache[1] = y;\n      changed = true;\n    }\n    if (cache[2] !== z) {\n      cache[2] = z;\n      changed = true;\n    }\n    if (cache[3] !== w) {\n      cache[3] = w;\n      changed = true;\n    }\n    return changed;\n  }\n  /**\n   * Sets an integer value on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param value Value to be set.\n   */\n  setInt(uniformName, value) {\n    const cache = this._valueCache[uniformName];\n    if (cache !== undefined && cache === value) {\n      return;\n    }\n    if (this.engine.setInt(this._uniforms[uniformName], value)) {\n      this._valueCache[uniformName] = value;\n    }\n  }\n  /**\n   * Sets a int2 on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param x First int in int2.\n   * @param y Second int in int2.\n   */\n  setInt2(uniformName, x, y) {\n    if (this._cacheFloat2(uniformName, x, y)) {\n      if (!this.engine.setInt2(this._uniforms[uniformName], x, y)) {\n        this._valueCache[uniformName] = null;\n      }\n    }\n  }\n  /**\n   * Sets a int3 on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param x First int in int3.\n   * @param y Second int in int3.\n   * @param z Third int in int3.\n   */\n  setInt3(uniformName, x, y, z) {\n    if (this._cacheFloat3(uniformName, x, y, z)) {\n      if (!this.engine.setInt3(this._uniforms[uniformName], x, y, z)) {\n        this._valueCache[uniformName] = null;\n      }\n    }\n  }\n  /**\n   * Sets a int4 on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param x First int in int4.\n   * @param y Second int in int4.\n   * @param z Third int in int4.\n   * @param w Fourth int in int4.\n   */\n  setInt4(uniformName, x, y, z, w) {\n    if (this._cacheFloat4(uniformName, x, y, z, w)) {\n      if (!this.engine.setInt4(this._uniforms[uniformName], x, y, z, w)) {\n        this._valueCache[uniformName] = null;\n      }\n    }\n  }\n  /**\n   * Sets an int array on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param array array to be set.\n   */\n  setIntArray(uniformName, array) {\n    this._valueCache[uniformName] = null;\n    this.engine.setIntArray(this._uniforms[uniformName], array);\n  }\n  /**\n   * Sets an int array 2 on a uniform variable. (Array is specified as single array eg. [1,2,3,4] will result in [[1,2],[3,4]] in the shader)\n   * @param uniformName Name of the variable.\n   * @param array array to be set.\n   */\n  setIntArray2(uniformName, array) {\n    this._valueCache[uniformName] = null;\n    this.engine.setIntArray2(this._uniforms[uniformName], array);\n  }\n  /**\n   * Sets an int array 3 on a uniform variable. (Array is specified as single array eg. [1,2,3,4,5,6] will result in [[1,2,3],[4,5,6]] in the shader)\n   * @param uniformName Name of the variable.\n   * @param array array to be set.\n   */\n  setIntArray3(uniformName, array) {\n    this._valueCache[uniformName] = null;\n    this.engine.setIntArray3(this._uniforms[uniformName], array);\n  }\n  /**\n   * Sets an int array 4 on a uniform variable. (Array is specified as single array eg. [1,2,3,4,5,6,7,8] will result in [[1,2,3,4],[5,6,7,8]] in the shader)\n   * @param uniformName Name of the variable.\n   * @param array array to be set.\n   */\n  setIntArray4(uniformName, array) {\n    this._valueCache[uniformName] = null;\n    this.engine.setIntArray4(this._uniforms[uniformName], array);\n  }\n  /**\n   * Sets an unsigned integer value on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param value Value to be set.\n   */\n  setUInt(uniformName, value) {\n    const cache = this._valueCache[uniformName];\n    if (cache !== undefined && cache === value) {\n      return;\n    }\n    if (this.engine.setUInt(this._uniforms[uniformName], value)) {\n      this._valueCache[uniformName] = value;\n    }\n  }\n  /**\n   * Sets an unsigned int2 value on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param x First unsigned int in uint2.\n   * @param y Second unsigned int in uint2.\n   */\n  setUInt2(uniformName, x, y) {\n    if (this._cacheFloat2(uniformName, x, y)) {\n      if (!this.engine.setUInt2(this._uniforms[uniformName], x, y)) {\n        this._valueCache[uniformName] = null;\n      }\n    }\n  }\n  /**\n   * Sets an unsigned int3 value on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param x First unsigned int in uint3.\n   * @param y Second unsigned int in uint3.\n   * @param z Third unsigned int in uint3.\n   */\n  setUInt3(uniformName, x, y, z) {\n    if (this._cacheFloat3(uniformName, x, y, z)) {\n      if (!this.engine.setUInt3(this._uniforms[uniformName], x, y, z)) {\n        this._valueCache[uniformName] = null;\n      }\n    }\n  }\n  /**\n   * Sets an unsigned int4 value on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param x First unsigned int in uint4.\n   * @param y Second unsigned int in uint4.\n   * @param z Third unsigned int in uint4.\n   * @param w Fourth unsigned int in uint4.\n   */\n  setUInt4(uniformName, x, y, z, w) {\n    if (this._cacheFloat4(uniformName, x, y, z, w)) {\n      if (!this.engine.setUInt4(this._uniforms[uniformName], x, y, z, w)) {\n        this._valueCache[uniformName] = null;\n      }\n    }\n  }\n  /**\n   * Sets an unsigned int array on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param array array to be set.\n   */\n  setUIntArray(uniformName, array) {\n    this._valueCache[uniformName] = null;\n    this.engine.setUIntArray(this._uniforms[uniformName], array);\n  }\n  /**\n   * Sets an unsigned int array 2 on a uniform variable. (Array is specified as single array eg. [1,2,3,4] will result in [[1,2],[3,4]] in the shader)\n   * @param uniformName Name of the variable.\n   * @param array array to be set.\n   */\n  setUIntArray2(uniformName, array) {\n    this._valueCache[uniformName] = null;\n    this.engine.setUIntArray2(this._uniforms[uniformName], array);\n  }\n  /**\n   * Sets an unsigned int array 3 on a uniform variable. (Array is specified as single array eg. [1,2,3,4,5,6] will result in [[1,2,3],[4,5,6]] in the shader)\n   * @param uniformName Name of the variable.\n   * @param array array to be set.\n   */\n  setUIntArray3(uniformName, array) {\n    this._valueCache[uniformName] = null;\n    this.engine.setUIntArray3(this._uniforms[uniformName], array);\n  }\n  /**\n   * Sets an unsigned int array 4 on a uniform variable. (Array is specified as single array eg. [1,2,3,4,5,6,7,8] will result in [[1,2,3,4],[5,6,7,8]] in the shader)\n   * @param uniformName Name of the variable.\n   * @param array array to be set.\n   */\n  setUIntArray4(uniformName, array) {\n    this._valueCache[uniformName] = null;\n    this.engine.setUIntArray4(this._uniforms[uniformName], array);\n  }\n  /**\n   * Sets an array on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param array array to be set.\n   */\n  setArray(uniformName, array) {\n    this._valueCache[uniformName] = null;\n    this.engine.setArray(this._uniforms[uniformName], array);\n  }\n  /**\n   * Sets an array 2 on a uniform variable. (Array is specified as single array eg. [1,2,3,4] will result in [[1,2],[3,4]] in the shader)\n   * @param uniformName Name of the variable.\n   * @param array array to be set.\n   */\n  setArray2(uniformName, array) {\n    this._valueCache[uniformName] = null;\n    this.engine.setArray2(this._uniforms[uniformName], array);\n  }\n  /**\n   * Sets an array 3 on a uniform variable. (Array is specified as single array eg. [1,2,3,4,5,6] will result in [[1,2,3],[4,5,6]] in the shader)\n   * @param uniformName Name of the variable.\n   * @param array array to be set.\n   */\n  setArray3(uniformName, array) {\n    this._valueCache[uniformName] = null;\n    this.engine.setArray3(this._uniforms[uniformName], array);\n  }\n  /**\n   * Sets an array 4 on a uniform variable. (Array is specified as single array eg. [1,2,3,4,5,6,7,8] will result in [[1,2,3,4],[5,6,7,8]] in the shader)\n   * @param uniformName Name of the variable.\n   * @param array array to be set.\n   */\n  setArray4(uniformName, array) {\n    this._valueCache[uniformName] = null;\n    this.engine.setArray4(this._uniforms[uniformName], array);\n  }\n  /**\n   * Sets matrices on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param matrices matrices to be set.\n   */\n  setMatrices(uniformName, matrices) {\n    if (!matrices) {\n      return;\n    }\n    this._valueCache[uniformName] = null;\n    this.engine.setMatrices(this._uniforms[uniformName], matrices);\n  }\n  /**\n   * Sets matrix on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param matrix matrix to be set.\n   */\n  setMatrix(uniformName, matrix) {\n    if (this._cacheMatrix(uniformName, matrix)) {\n      if (!this.engine.setMatrices(this._uniforms[uniformName], matrix.asArray())) {\n        this._valueCache[uniformName] = null;\n      }\n    }\n  }\n  /**\n   * Sets a 3x3 matrix on a uniform variable. (Specified as [1,2,3,4,5,6,7,8,9] will result in [1,2,3][4,5,6][7,8,9] matrix)\n   * @param uniformName Name of the variable.\n   * @param matrix matrix to be set.\n   */\n  setMatrix3x3(uniformName, matrix) {\n    this._valueCache[uniformName] = null;\n    this.engine.setMatrix3x3(this._uniforms[uniformName], matrix);\n  }\n  /**\n   * Sets a 2x2 matrix on a uniform variable. (Specified as [1,2,3,4] will result in [1,2][3,4] matrix)\n   * @param uniformName Name of the variable.\n   * @param matrix matrix to be set.\n   */\n  setMatrix2x2(uniformName, matrix) {\n    this._valueCache[uniformName] = null;\n    this.engine.setMatrix2x2(this._uniforms[uniformName], matrix);\n  }\n  /**\n   * Sets a float on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param value value to be set.\n   */\n  setFloat(uniformName, value) {\n    const cache = this._valueCache[uniformName];\n    if (cache !== undefined && cache === value) {\n      return;\n    }\n    if (this.engine.setFloat(this._uniforms[uniformName], value)) {\n      this._valueCache[uniformName] = value;\n    }\n  }\n  /**\n   * Sets a Vector2 on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param vector2 vector2 to be set.\n   */\n  setVector2(uniformName, vector2) {\n    if (this._cacheFloat2(uniformName, vector2.x, vector2.y)) {\n      if (!this.engine.setFloat2(this._uniforms[uniformName], vector2.x, vector2.y)) {\n        this._valueCache[uniformName] = null;\n      }\n    }\n  }\n  /**\n   * Sets a float2 on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param x First float in float2.\n   * @param y Second float in float2.\n   */\n  setFloat2(uniformName, x, y) {\n    if (this._cacheFloat2(uniformName, x, y)) {\n      if (!this.engine.setFloat2(this._uniforms[uniformName], x, y)) {\n        this._valueCache[uniformName] = null;\n      }\n    }\n  }\n  /**\n   * Sets a Vector3 on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param vector3 Value to be set.\n   */\n  setVector3(uniformName, vector3) {\n    if (this._cacheFloat3(uniformName, vector3.x, vector3.y, vector3.z)) {\n      if (!this.engine.setFloat3(this._uniforms[uniformName], vector3.x, vector3.y, vector3.z)) {\n        this._valueCache[uniformName] = null;\n      }\n    }\n  }\n  /**\n   * Sets a float3 on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param x First float in float3.\n   * @param y Second float in float3.\n   * @param z Third float in float3.\n   */\n  setFloat3(uniformName, x, y, z) {\n    if (this._cacheFloat3(uniformName, x, y, z)) {\n      if (!this.engine.setFloat3(this._uniforms[uniformName], x, y, z)) {\n        this._valueCache[uniformName] = null;\n      }\n    }\n  }\n  /**\n   * Sets a Vector4 on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param vector4 Value to be set.\n   */\n  setVector4(uniformName, vector4) {\n    if (this._cacheFloat4(uniformName, vector4.x, vector4.y, vector4.z, vector4.w)) {\n      if (!this.engine.setFloat4(this._uniforms[uniformName], vector4.x, vector4.y, vector4.z, vector4.w)) {\n        this._valueCache[uniformName] = null;\n      }\n    }\n  }\n  /**\n   * Sets a Quaternion on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param quaternion Value to be set.\n   */\n  setQuaternion(uniformName, quaternion) {\n    if (this._cacheFloat4(uniformName, quaternion.x, quaternion.y, quaternion.z, quaternion.w)) {\n      if (!this.engine.setFloat4(this._uniforms[uniformName], quaternion.x, quaternion.y, quaternion.z, quaternion.w)) {\n        this._valueCache[uniformName] = null;\n      }\n    }\n  }\n  /**\n   * Sets a float4 on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param x First float in float4.\n   * @param y Second float in float4.\n   * @param z Third float in float4.\n   * @param w Fourth float in float4.\n   */\n  setFloat4(uniformName, x, y, z, w) {\n    if (this._cacheFloat4(uniformName, x, y, z, w)) {\n      if (!this.engine.setFloat4(this._uniforms[uniformName], x, y, z, w)) {\n        this._valueCache[uniformName] = null;\n      }\n    }\n  }\n  /**\n   * Sets a Color3 on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param color3 Value to be set.\n   */\n  setColor3(uniformName, color3) {\n    if (this._cacheFloat3(uniformName, color3.r, color3.g, color3.b)) {\n      if (!this.engine.setFloat3(this._uniforms[uniformName], color3.r, color3.g, color3.b)) {\n        this._valueCache[uniformName] = null;\n      }\n    }\n  }\n  /**\n   * Sets a Color4 on a uniform variable.\n   * @param uniformName Name of the variable.\n   * @param color3 Value to be set.\n   * @param alpha Alpha value to be set.\n   */\n  setColor4(uniformName, color3, alpha) {\n    if (this._cacheFloat4(uniformName, color3.r, color3.g, color3.b, alpha)) {\n      if (!this.engine.setFloat4(this._uniforms[uniformName], color3.r, color3.g, color3.b, alpha)) {\n        this._valueCache[uniformName] = null;\n      }\n    }\n  }\n  /**\n   * Sets a Color4 on a uniform variable\n   * @param uniformName defines the name of the variable\n   * @param color4 defines the value to be set\n   */\n  setDirectColor4(uniformName, color4) {\n    if (this._cacheFloat4(uniformName, color4.r, color4.g, color4.b, color4.a)) {\n      if (!this.engine.setFloat4(this._uniforms[uniformName], color4.r, color4.g, color4.b, color4.a)) {\n        this._valueCache[uniformName] = null;\n      }\n    }\n  }\n  _getVertexShaderCode() {\n    return this.vertexShader ? this.engine._getShaderSource(this.vertexShader) : null;\n  }\n  _getFragmentShaderCode() {\n    return this.fragmentShader ? this.engine._getShaderSource(this.fragmentShader) : null;\n  }\n}\n//# sourceMappingURL=webGLPipelineContext.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}