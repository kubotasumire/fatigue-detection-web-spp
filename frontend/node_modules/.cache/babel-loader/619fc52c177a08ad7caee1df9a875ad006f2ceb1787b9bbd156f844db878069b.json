{"ast":null,"code":"/**\n * Manages the defines for the Material\n */\nexport class MaterialDefines {\n  /**\n   * Creates a new instance\n   * @param externalProperties list of external properties to inject into the object\n   */\n  constructor(externalProperties) {\n    /** @internal */\n    this._keys = [];\n    this._isDirty = true;\n    /** @internal */\n    this._areLightsDirty = true;\n    /** @internal */\n    this._areLightsDisposed = false;\n    /** @internal */\n    this._areAttributesDirty = true;\n    /** @internal */\n    this._areTexturesDirty = true;\n    /** @internal */\n    this._areFresnelDirty = true;\n    /** @internal */\n    this._areMiscDirty = true;\n    /** @internal */\n    this._arePrePassDirty = true;\n    /** @internal */\n    this._areImageProcessingDirty = true;\n    /** @internal */\n    this._normals = false;\n    /** @internal */\n    this._uvs = false;\n    /** @internal */\n    this._needNormals = false;\n    /** @internal */\n    this._needUVs = false;\n    this._externalProperties = externalProperties;\n    // Initialize External Properties\n    if (externalProperties) {\n      for (const prop in externalProperties) {\n        if (Object.prototype.hasOwnProperty.call(externalProperties, prop)) {\n          this._setDefaultValue(prop);\n        }\n      }\n    }\n  }\n  /**\n   * Specifies if the material needs to be re-calculated\n   */\n  get isDirty() {\n    return this._isDirty;\n  }\n  /**\n   * Marks the material to indicate that it has been re-calculated\n   */\n  markAsProcessed() {\n    this._isDirty = false;\n    this._areAttributesDirty = false;\n    this._areTexturesDirty = false;\n    this._areFresnelDirty = false;\n    this._areLightsDirty = false;\n    this._areLightsDisposed = false;\n    this._areMiscDirty = false;\n    this._arePrePassDirty = false;\n    this._areImageProcessingDirty = false;\n  }\n  /**\n   * Marks the material to indicate that it needs to be re-calculated\n   */\n  markAsUnprocessed() {\n    this._isDirty = true;\n  }\n  /**\n   * Marks the material to indicate all of its defines need to be re-calculated\n   */\n  markAllAsDirty() {\n    this._areTexturesDirty = true;\n    this._areAttributesDirty = true;\n    this._areLightsDirty = true;\n    this._areFresnelDirty = true;\n    this._areMiscDirty = true;\n    this._arePrePassDirty = false;\n    this._areImageProcessingDirty = true;\n    this._isDirty = true;\n  }\n  /**\n   * Marks the material to indicate that image processing needs to be re-calculated\n   */\n  markAsImageProcessingDirty() {\n    this._areImageProcessingDirty = true;\n    this._isDirty = true;\n  }\n  /**\n   * Marks the material to indicate the lights need to be re-calculated\n   * @param disposed Defines whether the light is dirty due to dispose or not\n   */\n  markAsLightDirty(disposed = false) {\n    this._areLightsDirty = true;\n    this._areLightsDisposed = this._areLightsDisposed || disposed;\n    this._isDirty = true;\n  }\n  /**\n   * Marks the attribute state as changed\n   */\n  markAsAttributesDirty() {\n    this._areAttributesDirty = true;\n    this._isDirty = true;\n  }\n  /**\n   * Marks the texture state as changed\n   */\n  markAsTexturesDirty() {\n    this._areTexturesDirty = true;\n    this._isDirty = true;\n  }\n  /**\n   * Marks the fresnel state as changed\n   */\n  markAsFresnelDirty() {\n    this._areFresnelDirty = true;\n    this._isDirty = true;\n  }\n  /**\n   * Marks the misc state as changed\n   */\n  markAsMiscDirty() {\n    this._areMiscDirty = true;\n    this._isDirty = true;\n  }\n  /**\n   * Marks the prepass state as changed\n   */\n  markAsPrePassDirty() {\n    this._arePrePassDirty = true;\n    this._isDirty = true;\n  }\n  /**\n   * Rebuilds the material defines\n   */\n  rebuild() {\n    this._keys.length = 0;\n    for (const key of Object.keys(this)) {\n      if (key[0] === \"_\") {\n        continue;\n      }\n      this._keys.push(key);\n    }\n    if (this._externalProperties) {\n      for (const name in this._externalProperties) {\n        if (this._keys.indexOf(name) === -1) {\n          this._keys.push(name);\n        }\n      }\n    }\n  }\n  /**\n   * Specifies if two material defines are equal\n   * @param other - A material define instance to compare to\n   * @returns - Boolean indicating if the material defines are equal (true) or not (false)\n   */\n  isEqual(other) {\n    if (this._keys.length !== other._keys.length) {\n      return false;\n    }\n    for (let index = 0; index < this._keys.length; index++) {\n      const prop = this._keys[index];\n      if (this[prop] !== other[prop]) {\n        return false;\n      }\n    }\n    return true;\n  }\n  /**\n   * Clones this instance's defines to another instance\n   * @param other - material defines to clone values to\n   */\n  cloneTo(other) {\n    if (this._keys.length !== other._keys.length) {\n      other._keys = this._keys.slice(0);\n    }\n    for (let index = 0; index < this._keys.length; index++) {\n      const prop = this._keys[index];\n      other[prop] = this[prop];\n    }\n  }\n  /**\n   * Resets the material define values\n   */\n  reset() {\n    this._keys.forEach(prop => this._setDefaultValue(prop));\n  }\n  _setDefaultValue(prop) {\n    const type = this._externalProperties?.[prop]?.type ?? typeof this[prop];\n    const defValue = this._externalProperties?.[prop]?.default;\n    switch (type) {\n      case \"number\":\n        this[prop] = defValue ?? 0;\n        break;\n      case \"string\":\n        this[prop] = defValue ?? \"\";\n        break;\n      default:\n        this[prop] = defValue ?? false;\n        break;\n    }\n  }\n  /**\n   * Converts the material define values to a string\n   * @returns - String of material define information\n   */\n  toString() {\n    let result = \"\";\n    for (let index = 0; index < this._keys.length; index++) {\n      const prop = this._keys[index];\n      const value = this[prop];\n      const type = typeof value;\n      switch (type) {\n        case \"number\":\n        case \"string\":\n          result += \"#define \" + prop + \" \" + value + \"\\n\";\n          break;\n        default:\n          if (value) {\n            result += \"#define \" + prop + \"\\n\";\n          }\n          break;\n      }\n    }\n    return result;\n  }\n}\n//# sourceMappingURL=materialDefines.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}