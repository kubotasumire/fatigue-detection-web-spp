{"ast":null,"code":"/** @internal */\nexport class WebGPUSnapshotRendering {\n  constructor(engine, renderingMode, bundleList) {\n    this._record = false;\n    this._play = false;\n    this._playBundleListIndex = 0;\n    this._allBundleLists = [];\n    this._enabled = false;\n    this._engine = engine;\n    this._mode = renderingMode;\n    this._bundleList = bundleList;\n  }\n  get enabled() {\n    return this._enabled;\n  }\n  get play() {\n    return this._play;\n  }\n  get record() {\n    return this._record;\n  }\n  set enabled(activate) {\n    this._allBundleLists.length = 0;\n    this._record = this._enabled = activate;\n    this._play = false;\n    if (activate) {\n      this._modeSaved = this._mode;\n      this._mode = 0; // need to reset to standard for the recording pass to avoid some code being bypassed\n    }\n  }\n  get mode() {\n    return this._mode;\n  }\n  set mode(mode) {\n    if (this._record) {\n      this._modeSaved = mode;\n    } else {\n      this._mode = mode;\n    }\n  }\n  endRenderPass(currentRenderPass) {\n    if (!this._record && !this._play) {\n      // Snapshot rendering mode is not enabled\n      return false;\n    }\n    let bundleList;\n    if (this._record) {\n      bundleList = this._bundleList.clone();\n      this._allBundleLists.push(bundleList);\n      this._bundleList.reset();\n    } else {\n      // We are playing the snapshot\n      if (this._playBundleListIndex >= this._allBundleLists.length) {\n        throw new Error(`Invalid playBundleListIndex! Your snapshot is no longer valid for the current frame, you should recreate a new one. playBundleListIndex=${this._playBundleListIndex}, allBundleLists.length=${this._allBundleLists.length}}`);\n      }\n      bundleList = this._allBundleLists[this._playBundleListIndex++];\n    }\n    bundleList.run(currentRenderPass);\n    if (this._mode === 1) {\n      this._engine._reportDrawCall(bundleList.numDrawCalls);\n    }\n    return true;\n  }\n  endFrame() {\n    if (this._record) {\n      // We stop recording and switch to replay mode for the next frames\n      this._record = false;\n      this._play = true;\n      this._mode = this._modeSaved;\n    }\n    this._playBundleListIndex = 0;\n  }\n  reset() {\n    this.enabled = false;\n    this.enabled = true;\n  }\n}\n//# sourceMappingURL=webgpuSnapshotRendering.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}