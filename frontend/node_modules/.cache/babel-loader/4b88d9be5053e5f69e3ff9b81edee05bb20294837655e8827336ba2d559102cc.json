{"ast":null,"code":"import { Observable } from \"./observable.js\";\nimport { runCoroutineAsync, inlineScheduler } from \"./coroutine.js\";\nfunction CreateObservableScheduler(observable) {\n  const coroutines = new Array();\n  const onSteps = new Array();\n  const onErrors = new Array();\n  const observer = observable.add(() => {\n    const count = coroutines.length;\n    for (let i = 0; i < count; i++) {\n      inlineScheduler(coroutines.shift(), onSteps.shift(), onErrors.shift());\n    }\n  });\n  const scheduler = (coroutine, onStep, onError) => {\n    coroutines.push(coroutine);\n    onSteps.push(onStep);\n    onErrors.push(onError);\n  };\n  return {\n    scheduler: scheduler,\n    dispose: () => {\n      observable.remove(observer);\n    }\n  };\n}\nObservable.prototype.runCoroutineAsync = function (coroutine) {\n  if (!this._coroutineScheduler) {\n    const schedulerAndDispose = CreateObservableScheduler(this);\n    this._coroutineScheduler = schedulerAndDispose.scheduler;\n    this._coroutineSchedulerDispose = schedulerAndDispose.dispose;\n  }\n  return runCoroutineAsync(coroutine, this._coroutineScheduler);\n};\nObservable.prototype.cancelAllCoroutines = function () {\n  if (this._coroutineSchedulerDispose) {\n    this._coroutineSchedulerDispose();\n  }\n  this._coroutineScheduler = undefined;\n  this._coroutineSchedulerDispose = undefined;\n};\n//# sourceMappingURL=observableCoroutine.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}