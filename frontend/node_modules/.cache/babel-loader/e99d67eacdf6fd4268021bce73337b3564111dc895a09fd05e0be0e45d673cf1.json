{"ast":null,"code":"import { Tools } from \"../../Misc/tools.js\";\n/**\n * Meshopt compression (https://github.com/zeux/meshoptimizer)\n *\n * This class wraps the meshopt library from https://github.com/zeux/meshoptimizer/tree/master/js.\n *\n * **Encoder**\n *\n * The encoder is not currently implemented.\n *\n * **Decoder**\n *\n * By default, the configuration points to a copy of the meshopt files on the Babylon.js preview CDN (e.g. https://preview.babylonjs.com/meshopt_decoder.js).\n *\n * To update the configuration, use the following code:\n * ```javascript\n *     MeshoptCompression.Configuration = {\n *         decoder: {\n *             url: \"<url to the meshopt decoder library>\"\n *         }\n *     };\n * ```\n */\nexport class MeshoptCompression {\n  /**\n   * Default instance for the meshoptimizer object.\n   */\n  static get Default() {\n    if (!MeshoptCompression._Default) {\n      MeshoptCompression._Default = new MeshoptCompression();\n    }\n    return MeshoptCompression._Default;\n  }\n  /**\n   * Constructor\n   */\n  constructor() {\n    const decoder = MeshoptCompression.Configuration.decoder;\n    this._decoderModulePromise = Tools.LoadBabylonScriptAsync(decoder.url).then(() => {\n      // Wait for WebAssembly compilation before resolving promise\n      return MeshoptDecoder.ready;\n    });\n  }\n  /**\n   * Stop all async operations and release resources.\n   */\n  dispose() {\n    delete this._decoderModulePromise;\n  }\n  /**\n   * Decode meshopt data.\n   * @see https://github.com/zeux/meshoptimizer/tree/master/js#decoder\n   * @param source The input data.\n   * @param count The number of elements.\n   * @param stride The stride in bytes.\n   * @param mode The compression mode.\n   * @param filter The compression filter.\n   * @returns a Promise<Uint8Array> that resolves to the decoded data\n   */\n  decodeGltfBufferAsync(source, count, stride, mode, filter) {\n    return this._decoderModulePromise.then(() => {\n      const result = new Uint8Array(count * stride);\n      MeshoptDecoder.decodeGltfBuffer(result, count, stride, source, mode, filter);\n      return result;\n    });\n  }\n}\n/**\n * The configuration. Defaults to the following:\n * ```javascript\n * decoder: {\n *   url: \"https://cdn.babylonjs.com/meshopt_decoder.js\"\n * }\n * ```\n */\nMeshoptCompression.Configuration = {\n  decoder: {\n    url: `${Tools._DefaultCdnUrl}/meshopt_decoder.js`\n  }\n};\nMeshoptCompression._Default = null;\n//# sourceMappingURL=meshoptCompression.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}