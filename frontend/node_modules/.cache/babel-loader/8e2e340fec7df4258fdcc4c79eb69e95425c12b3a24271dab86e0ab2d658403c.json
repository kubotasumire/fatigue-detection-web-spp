{"ast":null,"code":"import { RichTypeNumber } from \"../../../flowGraphRichTypes.js\";\nimport { FlowGraphExecutionBlockWithOutSignal } from \"../../../flowGraphExecutionBlockWithOutSignal.js\";\nimport { RegisterClass } from \"../../../../Misc/typeStore.js\";\n/**\n * @experimental\n * A block that throttles the execution of its output flow.\n */\nexport class FlowGraphThrottleBlock extends FlowGraphExecutionBlockWithOutSignal {\n  constructor(config) {\n    super(config);\n    this.reset = this._registerSignalInput(\"reset\");\n    this.duration = this.registerDataInput(\"duration\", RichTypeNumber);\n    this.timeRemaining = this.registerDataOutput(\"timeRemaining\", RichTypeNumber);\n  }\n  _execute(context, callingSignal) {\n    const lastExecutedTime = context._getExecutionVariable(this, \"lastExecutedTime\");\n    const durationValue = this.duration.getValue(context);\n    const currentTime = Date.now();\n    if (callingSignal === this.reset || lastExecutedTime === undefined || currentTime - lastExecutedTime > durationValue) {\n      //activate the output flow\n      this.timeRemaining.setValue(0, context);\n      this.out._activateSignal(context);\n      context._setExecutionVariable(this, \"lastExecutedTime\", currentTime);\n    } else {\n      //activate the output flow after the remaining time\n      const remaining = durationValue - (currentTime - lastExecutedTime);\n      this.timeRemaining.setValue(remaining, context);\n    }\n  }\n  /**\n   * @returns class name of the block.\n   */\n  getClassName() {\n    return \"FGThrottleBlock\";\n  }\n}\nRegisterClass(\"FGThrottleBlock\", FlowGraphThrottleBlock);\n//# sourceMappingURL=flowGraphThrottleBlock.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}